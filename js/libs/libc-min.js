// Version 0.1.1
(function(a){var b=function(){var b=location.hash;if(a(".current-tentacle").length>0){b=a(".current-tentacle").attr("href");var c=b.substr(1);location.hash="#_"+c}else{b=location.hash;b!==""?b="#"+b.substr(2):b="#tab-1"}a(".lif-tab").hide();a(b).show();a(".lif-title").addClass("nav-tab-wrapper").addClass("lif-active").find("span").remove();a('[href="'+b+'"]').addClass("nav-tab-active");a(".lif-title .nav-tab").removeClass("hidden").click(function(b){var c=a(this),d;a(".updated").hide();if(c.hasClass("nav-tab-active"))return!1;a(".li-settings").remove();a(".lif-tab").hide();a(c.attr("href")).show();a(".nav-tab").removeClass("nav-tab-active");c.addClass("nav-tab-active");d=c.attr("href").substr(1);var e="_"+d;window.location.hash=e;a("#current_tentacle").length<1?a(".line-in-plugin form").append("<input type='hidden' name='current_tentacle' id='current_tentacle' value='"+d+"' />"):a("#current_tentacle").val(d);return!1})};a(".lif-title").hasClass("lif-active")||b()})(jQuery);jQuery(document).ready(function(a){var b=!1,c=!1,d=!1;jQuery(".li-upload").click(function(){b=jQuery(this).attr("id").substr(4);c="set";tb_show("","media-upload.php?type=image&amp;TB_iframe=true#true");return!1});window.original_send_to_editor=window.send_to_editor;window.send_to_editor=function(d){if(c){var d=a("<div />").append(d);img=a("img",d);imgurl=jQuery("img",d).attr("src");jQuery("#"+b).val(imgurl);tb_remove()}else window.original_send_to_editor(d);c=!1};a(".li-advanced-options").each(function(){var b=a(this),c=a(this).attr("href"),d=parseInt(c.substr(1,1)),e=c.substr(2);b.click(function(){var c=a(this).hasClass("li-selected");c?b.text("Open Advanced Options"):b.text("Close Advanced Options");b.toggleClass("li-selected");a("."+e).toggle(!c);return!1});if(d>0){var f=b.parents("tr").next();for(var g=1;g<=d;g++){f.addClass(e).hide();f=f.next()}}});var e=!1;a(".colorpicker-select").click(function(){e=a(this).attr("id")});a(".colorpicker-hex, .colorpicker-a").keyup(function(){var b=a(this);currentId=a(b).attr("id").replace("-hex","").replace("-a","");currentTransparency=parseInt(a("#"+currentId+"-a").val());currentHex=a("#"+currentId+"-hex").val();transparency=currentTransparency/100;a("#"+currentId+" div").ColorPickerSetColor(currentHex).css("backgroundColor","#"+currentHex).css("opacity",transparency)});a(".colorpicker-select").ColorPicker({onShow:function(b){a(this).ColorPickerSetColor(a("#"+a(this).attr("id")+"-hex").val());a(b).fadeIn(500);return!1},onHide:function(b){a(b).fadeOut(500);return!1},onChange:function(b,c,d){a("#"+e+" div").css("backgroundColor","#"+c);a("#"+e+"-hex").val(c);a("#"+e+"-r").val(d.r);a("#"+e+"-g").val(d.g);a("#"+e+"-b").val(d.b)}})});(function(a){var b=function(){var b={},c,d=65,e,f='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',g={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},h=function(b,c){var d=O(b);a(c).data("colorpicker").fields.eq(1).val(d.r).end().eq(2).val(d.g).end().eq(3).val(d.b).end()},i=function(b,c){a(c).data("colorpicker").fields.eq(4).val(b.h).end().eq(5).val(b.s).end().eq(6).val(b.b).end()},j=function(b,c){a(c).data("colorpicker").fields.eq(0).val(Q(b)).end()},k=function(b,c){a(c).data("colorpicker").selector.css("backgroundColor","#"+Q({h:b.h,s:100,b:100}));a(c).data("colorpicker").selectorIndic.css({left:parseInt(150*b.s/100,10),top:parseInt(150*(100-b.b)/100,10)})},l=function(b,c){a(c).data("colorpicker").hue.css("top",parseInt(150-150*b.h/360,10))},m=function(b,c){a(c).data("colorpicker").currentColor.css("backgroundColor","#"+Q(b))},n=function(b,c){a(c).data("colorpicker").newColor.css("backgroundColor","#"+Q(b))},o=function(b){var c=b.charCode||b.keyCode||-1;if(c>d&&c<=90||c==32)return!1;var e=a(this).parent().parent();e.data("colorpicker").livePreview===!0&&p.apply(this)},p=function(b){var c=a(this).parent().parent(),d;this.parentNode.className.indexOf("_hex")>0?c.data("colorpicker").color=d=M(K(this.value)):this.parentNode.className.indexOf("_hsb")>0?c.data("colorpicker").color=d=I({h:parseInt(c.data("colorpicker").fields.eq(4).val(),10),s:parseInt(c.data("colorpicker").fields.eq(5).val(),10),b:parseInt(c.data("colorpicker").fields.eq(6).val(),10)}):c.data("colorpicker").color=d=N(J({r:parseInt(c.data("colorpicker").fields.eq(1).val(),10),g:parseInt(c.data("colorpicker").fields.eq(2).val(),10),b:parseInt(c.data("colorpicker").fields.eq(3).val(),10)}));if(b){h(d,c.get(0));j(d,c.get(0));i(d,c.get(0))}k(d,c.get(0));l(d,c.get(0));n(d,c.get(0));c.data("colorpicker").onChange.apply(c,[d,Q(d),O(d)])},q=function(b){var c=a(this).parent().parent();c.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},r=function(){d=this.parentNode.className.indexOf("_hex")>0?70:65;a(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus");a(this).parent().addClass("colorpicker_focus")},s=function(b){var c=a(this).parent().find("input").focus(),d={el:a(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:b.pageY,field:c,val:parseInt(c.val(),10),preview:a(this).parent().parent().data("colorpicker").livePreview};a(document).bind("mouseup",d,u);a(document).bind("mousemove",d,t)},t=function(a){a.data.field.val(Math.max(0,Math.min(a.data.max,parseInt(a.data.val+a.pageY-a.data.y,10))));a.data.preview&&p.apply(a.data.field.get(0),[!0]);return!1},u=function(b){p.apply(b.data.field.get(0),[!0]);b.data.el.removeClass("colorpicker_slider").find("input").focus();a(document).unbind("mouseup",u);a(document).unbind("mousemove",t);return!1},v=function(b){var c={cal:a(this).parent(),y:a(this).offset().top};c.preview=c.cal.data("colorpicker").livePreview;a(document).bind("mouseup",c,x);a(document).bind("mousemove",c,w)},w=function(a){p.apply(a.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,a.pageY-a.data.y)))/150,10)).get(0),[a.data.preview]);return!1},x=function(b){h(b.data.cal.data("colorpicker").color,b.data.cal.get(0));j(b.data.cal.data("colorpicker").color,b.data.cal.get(0));a(document).unbind("mouseup",x);a(document).unbind("mousemove",w);return!1},y=function(b){var c={cal:a(this).parent(),pos:a(this).offset()};c.preview=c.cal.data("colorpicker").livePreview;a(document).bind("mouseup",c,A);a(document).bind("mousemove",c,z)},z=function(a){p.apply(a.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,a.pageY-a.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,a.pageX-a.data.pos.left))/150,10)).get(0),[a.data.preview]);return!1},A=function(b){h(b.data.cal.data("colorpicker").color,b.data.cal.get(0));j(b.data.cal.data("colorpicker").color,b.data.cal.get(0));a(document).unbind("mouseup",A);a(document).unbind("mousemove",z);return!1},B=function(b){a(this).addClass("colorpicker_focus")},C=function(b){a(this).removeClass("colorpicker_focus")},D=function(b){var c=a(this).parent(),d=c.data("colorpicker").color;c.data("colorpicker").origColor=d;m(d,c.get(0));c.data("colorpicker").onSubmit(d,Q(d),O(d),c.data("colorpicker").el)},E=function(b){var c=a("#"+a(this).data("colorpickerId"));c.data("colorpicker").onBeforeShow.apply(this,[c.get(0)]);var d=a(this).offset(),e=H(),f=d.top+this.offsetHeight,g=d.left;f+176>e.t+e.h&&(f-=this.offsetHeight+176);g+356>e.l+e.w&&(g-=356);c.css({left:g+"px",top:f+"px"});c.data("colorpicker").onShow.apply(this,[c.get(0)])!=0&&c.show();a(document).bind("mousedown",{cal:c},F);return!1},F=function(b){if(!G(b.data.cal.get(0),b.target,b.data.cal.get(0))){b.data.cal.data("colorpicker").onHide.apply(this,[b.data.cal.get(0)])!=0&&b.data.cal.hide();a(document).unbind("mousedown",F)}},G=function(a,b,c){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);var d=b.parentNode;while(d&&d!=c){if(d==a)return!0;d=d.parentNode}return!1},H=function(){var a=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(a?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(a?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(a?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(a?document.documentElement.clientHeight:document.body.clientHeight)}},I=function(a){return{h:Math.min(360,Math.max(0,a.h)),s:Math.min(100,Math.max(0,a.s)),b:Math.min(100,Math.max(0,a.b))}},J=function(a){return{r:Math.min(255,Math.max(0,a.r)),g:Math.min(255,Math.max(0,a.g)),b:Math.min(255,Math.max(0,a.b))}},K=function(a){var b=6-a.length;if(b>0){var c=[];for(var d=0;d<b;d++)c.push("0");c.push(a);a=c.join("")}return a},L=function(a){var a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return{r:a>>16,g:(a&65280)>>8,b:a&255}},M=function(a){return N(L(a))},N=function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;b.b=d;d==0;b.s=d!=0?255*e/d:0;b.s!=0?a.r==d?b.h=(a.g-a.b)/e:a.g==d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1;b.h*=60;b.h<0&&(b.h+=360);b.s*=100/255;b.b*=100/255;return b},O=function(a){var b={},c=Math.round(a.h),d=Math.round(a.s*255/100),e=Math.round(a.b*255/100);if(d==0)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;c==360&&(c=0);if(c<60){b.r=f;b.b=g;b.g=g+h}else if(c<120){b.g=f;b.b=g;b.r=f-h}else if(c<180){b.g=f;b.r=g;b.b=g+h}else if(c<240){b.b=f;b.r=g;b.g=f-h}else if(c<300){b.b=f;b.g=g;b.r=g+h}else if(c<360){b.r=f;b.g=g;b.b=f-h}else{b.r=0;b.g=0;b.b=0}}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}},P=function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];a.each(c,function(a,b){b.length==1&&(c[a]="0"+b)});return c.join("")},Q=function(a){return P(O(a))},R=function(){var b=a(this).parent(),c=b.data("colorpicker").origColor;b.data("colorpicker").color=c;h(c,b.get(0));j(c,b.get(0));i(c,b.get(0));k(c,b.get(0));l(c,b.get(0));n(c,b.get(0))};return{init:function(b){b=a.extend({},g,b||{});if(typeof b.color=="string")b.color=M(b.color);else if(b.color.r!=undefined&&b.color.g!=undefined&&b.color.b!=undefined)b.color=N(b.color);else if(b.color.h!=undefined&&b.color.s!=undefined&&b.color.b!=undefined)b.color=I(b.color);else return this;return this.each(function(){if(!a(this).data("colorpickerId")){var c=a.extend({},b);c.origColor=b.color;var d="collorpicker_"+parseInt(Math.random()*1e3);a(this).data("colorpickerId",d);var e=a(f).attr("id",d);c.flat?e.appendTo(this).show():e.appendTo(document.body);c.fields=e.find("input").bind("keyup",o).bind("change",p).bind("blur",q).bind("focus",r);e.find("span").bind("mousedown",s).end().find(">div.colorpicker_current_color").bind("click",R);c.selector=e.find("div.colorpicker_color").bind("mousedown",y);c.selectorIndic=c.selector.find("div div");c.el=this;c.hue=e.find("div.colorpicker_hue div");e.find("div.colorpicker_hue").bind("mousedown",v);c.newColor=e.find("div.colorpicker_new_color");c.currentColor=e.find("div.colorpicker_current_color");e.data("colorpicker",c);e.find("div.colorpicker_submit").bind("mouseenter",B).bind("mouseleave",C).bind("click",D);h(c.color,e.get(0));i(c.color,e.get(0));j(c.color,e.get(0));l(c.color,e.get(0));k(c.color,e.get(0));m(c.color,e.get(0));n(c.color,e.get(0));c.flat?e.css({position:"relative",display:"block"}):a(this).bind(c.eventName,E)}})},showPicker:function(){return this.each(function(){a(this).data("colorpickerId")&&E.apply(this)})},hidePicker:function(){return this.each(function(){a(this).data("colorpickerId")&&a("#"+a(this).data("colorpickerId")).hide()})},setColor:function(b){if(typeof b=="string")b=M(b);else if(b.r!=undefined&&b.g!=undefined&&b.b!=undefined)b=N(b);else if(b.h!=undefined&&b.s!=undefined&&b.b!=undefined)b=I(b);else return this;return this.each(function(){if(a(this).data("colorpickerId")){var c=a("#"+a(this).data("colorpickerId"));c.data("colorpicker").color=b;c.data("colorpicker").origColor=b;h(b,c.get(0));i(b,c.get(0));j(b,c.get(0));l(b,c.get(0));k(b,c.get(0));m(b,c.get(0));n(b,c.get(0))}})}}}();a.fn.extend({ColorPicker:b.init,ColorPickerHide:b.hidePicker,ColorPickerShow:b.showPicker,ColorPickerSetColor:b.setColor})})(jQuery);